<?phpadd_action('admin_notices', 'avcp_custom_notice');function avcp_custom_notice(){    global $current_screen;    if ( 'ditte' == $current_screen->taxonomy )        {            echo '<div class="updated" style="background-color: #f1f1f1;color: black;font-weight: bold;border: none;box-shadow: none;font-size: 20px;font-family: verdana;"><p>Attenzione: ogni modifica effettuata a una ditta si applica anche alle gare già pubblicate!</p></div>';        }}/* Display a thankyou notice */add_action('admin_notices', 'avcp_admin_messages');function avcp_admin_messages() {	global $current_user ;        $user_id = $current_user->ID;	$get_avcp_invalid = get_option('avcp_invalid');	if ($get_avcp_invalid == '1') {		echo '<div class="error"><p>AVCP | Alcuni dataset .xml non hanno superato il controllo di validazione</p><p><a href="' . admin_url() . 'edit.php?post_type=avcp&page=avcp_v_dataset">Clicca qui vedere i dettagli degli errori</a></div>';	}		$get_avcp_denominazione_ente = get_option('avcp_denominazione_ente');	if ($get_avcp_denominazione_ente  == null) {		echo '<div class="error"><p>AVCP | DENOMINAZIONE ENTE MANCANTE IN <b>AVCP > IMPOSTAZIONI</b></a></div>';	}	$get_avcp_codicefiscale_ente = get_option('avcp_codicefiscale_ente');	if ($get_avcp_codicefiscale_ente  == null) {		echo '<div class="error"><p>AVCP | PARTITA IVA ENTE MANCANTE IN <b>AVCP > IMPOSTAZIONI</b></a></div>';	}		$termcheck = term_exists('2012', 'annirif');	if (!($termcheck == 0 || $termcheck == null)) {		if ( is_admin() && current_user_can( 'manage_options' ) && !get_user_meta($user_id, 'avcp_upgrade_3') ) {			echo '<div class="error"><p>'; 			printf(__('AVCP | Per completare l\'aggiornamento alla versione 3.0 è necessario spostare le gare con anno di riferimento "2012" in "2013".<br/>			<br/><a class="add-new-h2" href="%1$s">Clicca qui per eseguire automaticamente lo spostamento e per eliminare la voce anno di riferimento 2012</a>.'), '?avcp_upgrade_3=0');			echo "</p></div>";		}	}		//if ( ! get_user_meta($user_id, 'avcp_thankyou_ignore_notice') ) {    //    echo '<div class="updated"><p>';     //    printf(__('Grazie per avere installato Amministrazione Trasparente!<br/>Per la gestione delle spese dai un\'occhiata a <a href="http://wordpress.org/plugins/amministrazione-aperta/" target="_blank">Amministrazione Aperta</a> | <a href="%1$s">Nascondi</a>'), '?avcp_thankyou_nag_ignore=0');    //    echo "</p></div>";	//}		//global $pagenow;	//if (( $pagenow == 'post.php' || $pagenow == 'post-new.php' ) && ($_GET['post_type'] == 'at_gara')) {    //echo '<div class="error"><p>';      //   printf(__('Attenzione! Stai usando una versione beta di AVCP for Wordpress. Procedi a tuo rischio e pericolo'));     //   echo "</p></div>";    //}}add_action('admin_init', 'avcp_admin_messages_ignore');function avcp_admin_messages_ignore() {	global $current_user;        $user_id = $current_user->ID;        /* If user clicks to ignore the notice, add that to their user meta */				if ( isset($_GET['avcp_upgrade_3']) && '0' == $_GET['avcp_upgrade_3'] ) { // 19 gennaio 2014			query_posts( array( 'post_type' => 'avcp',  'posts_per_page' => '-1', 'annirif' => '2012') ); global $post;				if ( have_posts() ) : while ( have_posts() ) : the_post();					wp_remove_object_terms( $post->ID, '2012', 'annirif' );					wp_add_object_terms( $post->ID, '2013', 'annirif' );				endwhile; else:			endif;			$get_term = get_term_by('name', '2012', 'annirif');			$t_id = $get_term->term_id;			wp_delete_term( $t_id, 'annirif' );			add_user_meta($user_id, 'avcp_upgrade_3', 'true', true);			unlink(ABSPATH . 'avcp/2012.xml');		}				if ( isset($_GET['avcp_upgrade_2date_ignore']) && '0' == $_GET['avcp_upgrade_2date_ignore'] ) {             add_user_meta($user_id, 'avcp_upgrade_2date', 'true', true);		}}?>